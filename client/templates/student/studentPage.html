<template name="studentPage">
  
  <!--
    <div class="students_buttons">
      <button type="button" class="btn btn-danger all_button">Todos</button>
      {{#each students}}
        <button type="button" class="btn btn-info student_button" id="{{_id}}">{{studentName}}</button>
      {{/each}}
    </div>
  -->
  <div style="background-color:#002B36;">
    <div class="list-group">
      {{#with student}}
        {{#if parent}}
          <h2 class="text-center bg-primary"><span id="alias">{{alias}}</span></h2>
        {{else}}
          <h2 class="text-center bg-primary"><span id="alias">{{alias}}</span> ({{studentName}})</h2>
        {{/if}}
        <div class="container-fluid">
          <img src="{{image avatar}}" name="{{_id}}" alt="..." class="img fotoStudent">
          <div class="puntsStudent">
              <div class="list-group" id="{{_id}}">
                <li class="list-group-item list-group-item-warning btn-level" data-toggle="modal">N{{levelAutomatic (_id)}} {{levelDesc (_id)}}</li>
                <li class="list-group-item list-group-item-success btn-xp" data-toggle="modal">{{XP}} XP</li>
                <li class="list-group-item list-group-item-danger btn-hp"  data-toggle="modal">{{HP}} HP</li>
                <li class="list-group-item list-group-item-info btn-badge" data-toggle="modal">{{badges.length}} BG</li>
                <li class="list-group-item list-group-item-warning btn-store" data-toggle="modal" data-target="#store_modal">{{coins}} €</li>
              </div>
          </div>
          <form class="dataStudent">
            <div class="form-group">
              <label for="sName" class="control-label">ID estudiante</label>
              <input type="text" class="form-control" id="sName" name="idName" value="{{_id}}" readonly="readonly">
              <label for="sName" class="control-label">Nombre estudiante</label>
              {{#if parent}}
                <input type="text" class="form-control" id="sName" name="sName" value="{{alias}}" {{inputDisabled}}>
              {{else}}
                <input type="text" class="form-control" id="sName" name="sName" value="{{studentName}}" {{inputDisabled}}>
              {{/if}}
              <label for="sLevel" class="control-label">{{_ "level"}}</label>
              <!-- <input type="text" class="form-control" id="sLevel" name="sLevel" value="{{level}}" {{inputDisabled}}>-->
              <select class="form-control" id="sLevel" name="sLevel" {{inputDisabled}}>
                {{#each selectLevels}}
                  <option value="{{level}}" {{levelSelected level}}>{{level}}.- {{levelDescription}}</option>
                {{/each}}
              </select>
              <label for="sAlias" class="control-label">Alias</label>
              <input type="text" class="form-control" id="sAlias" name="sAlias"  value="{{alias}}" {{inputDisabled}}>
              <label for="sAvatar" class="control-label">Avatar</label>
              <input type="text" class="form-control" id="sAvatar" name="sAvatar"  value="{{avatar}}" {{inputDisabled}}>
              <button id="cloudinary" name="cloudinary" {{inputDisabled}}>Subir imagen</button>
              <!--
                <button id="cloudinaryList" name="cloudinaryList" {{inputDisabled}}>Ver imagenes</button>
              -->
              <br/>
              <label for="sEmail" class="control-label">email</label>
              <input type="text" class="form-control" id="sEmail" name="sEmail" value="{{email}}" {{inputDisabled}}>
            </div>
            {{#if teacher}}
            <div style="float:right;margin-bottom:20px;">
              <button type="button" class="btn btn-default">Volver a clase</button>
              <input type="submit" class="btn btn-primary" value="{{_ "save"}}">
            </div>
            {{/if}}
          </form>
        </div>
      {{/with}}
    </div>
    <div class="container-fluid section table-responsive">
      <br />
      <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
        <div class="panel panel-info">
          <div class="panel-heading" role="button" id="headingDaP"  data-toggle="collapse" data-parent="#accordion" href="#collapseDaP" aria-expanded="false" aria-controls="collapseDaP">
            <li class="panel-title list-group-item">
                Diario y Portfolio del estudiante
            </li>
          </div>
          <div id="collapseDaP" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingDaP">
            <div class="panel-body">
              {{#with student}}
                <div class="form-group has-success">
                  <div class="form-inline">
                    <div class="input-group col-xs-10">
                      <span class="input-group-addon">Diario</span>
                      <input type="text" class="form-control inputGroup input-lg" id="Diary" {{myuserEnabled}} value="{{diary}}">
                    </div>
                    <div class="input-group col-xs-1">
                      <a href="{{diary}}" class="btn btn-success" id="seeDiary" target="_blank">Ver Diario</a>
                    </div>
                  </div>
                  <div class="form-inline">
                    <div class="input-group col-xs-10">
                      <span class="input-group-addon">Portfolio</span>
                      <input type="text" class="form-control inputGroup input-lg" id="Portfolio" {{myuserEnabled}} value="{{portfolio}}">
                    </div>
                    <div class="input-group col-xs-1">
                      <a href="{{portfolio}}" class="btn btn-success" id="seePortfolio" target="_blank">Ver Portfolio</a>
                    </div>
                  </div>
                </div>
              {{/with}}
            </div>
          </div>
        </div>
        <div class="panel panel-info">
          <div class="panel-heading" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseMaC" aria-expanded="false" aria-controls="collapseMaC" id="headingMaC">
            <li class="panel-title list-group-item">
                Misiones y Retos
            </li>
          </div>
          <div id="collapseMaC" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingMaC">
            <div class="panel-body">
              {{#each mac}}
                <div class="form-group {{moc type}}">
                  <div class="form-inline">
                    <div class="input-group col-xs-9">
                      <span class="input-group-addon">{{type}}</span>
                      <input type="text" class="form-control inputGroup input-lg" readonly name="chalName" aria-describedby="inputGroupSuccess1Status" value="{{chalName}}">
                    </div>
                    <div class="input-group col-xs-2">
                      <span class="input-group-addon">Puntuación</span>
                      <input type="text" class="form-control inputGroup input-lg cp" name="{{type}}" id="{{_id}}" {{inputDisabled}} aria-describedby="inputGroupSuccess1Status" value="{{CP _id}}">
                    </div>
                  </div>
                </div>
              {{/each}}
            </div>
          </div>
        </div>
        <div class="panel panel-info">
          <div class="panel-heading" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseBadges" aria-expanded="false" aria-controls="collapseBadges" id="headingBadges">
            <li class="panel-title list-group-item">
                Insignias
            </li>
          </div>
          <div id="collapseBadges" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingBadges">
            <div class="panel-body">
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th>
                      Descripción
                    </th>
                    <th>
                      XP
                    </th>
                    <th>
                      Fecha
                    </th>
                  </tr>
                </thead>
                <tbody>
                {{#each badges}}
                  <tr>
                    <td>
                      {{badge.badgeDescription}}
                    </td>
                    <td>
                      {{badge.points}}
                    </td>
                    <td>
                      {{createdOn}}
                    </td>
                  </tr>
                {{/each}}
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="panel panel-info">
          <div class="panel-heading" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseHistory" aria-expanded="false" aria-controls="collapseHistory" id="headingHistory">
            <li class="panel-title list-group-item">
                Historial
            </li>
          </div>
          <div id="collapseHistory" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingHistory">
            <div class="panel-body">
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th id="evaluation_th">
                      Evaluación
                    </th>
                    <th id="behaviour_th">
                      Comportamiento
                    </th>
                    <th>
                      Comentarios
                    </th>
                    <th>
                      Puntos
                    </th>
                     <th id="behaviour_type_th">
                      Tipo
                    </th>
                    <th id="date_th">
                      Fecha
                    </th>
                    <th id="borrar_th">
                      Borrar
                    </th>
                  </tr>
                </thead>
                <tbody>
                {{#each statistics}}
                      <tr>
                        <td>
                          {{evaluation}}
                        </td>
                        <td>
                          {{behaviour.behaviourDescription}}
                        </td>
                        <td>
                          {{comment}}
                        </td>
                        <td>
                          {{behaviour.points}}
                        </td>
                        <td>
                          {{behaviourType}}
                        </td>
                        <td>
                          {{createdOnFormatted createdOn}}
                        </td>
                        {{#if teacher}}
                          <td class="text-center">
                            <button name="{{_id}}" class="borrar">Borrar</button>
                          </td>
                        {{/if}}
                      </tr>
                {{/each}}
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="panel panel-info">
          <div class="panel-heading" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseDiary" aria-expanded="false" aria-controls="collapseDiary" id="headingDiary">
            <li class="panel-title list-group-item">
                Diario de aprendizaje
            </li>
          </div>
          <div id="collapseDiary" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingDiary">
            <div class="panel-body">
              <div class="panel-group" id="accordionDiary" role="tablist" aria-multiselectable="true">
                  {{#each mydiary}}
                  <div class="panel panel-success">
                    <div class="panel-heading" role="button" data-toggle="collapse" data-parent="#accordionDiary" href="#collapse{{_id}}" aria-expanded="false" aria-controls="collapse{{_id}}" id="heading{{_id}}">
                      <h4 class="panel-title">
                          Misión "{{mision.chalName}}" ( {{createdOn}} )
                    </h4>
                    </div>
                    <div id="collapse{{_id}}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading{{_id}}">
                      <div class="panel-body">
                        <div class="panel panel-default">
                          <ul class="list-group">
                              <a href="#" class="list-group-item list-group-item-default">
                                <h4 class="list-group-item-heading">¿Qué hemos aprendido hoy? </h4>
                                <p class="list-group-item-text">{{what}}</p>
                              </a>
                              <a href="#" class="list-group-item list-group-item-default">
                                <h4 class="list-group-item-heading">¿Cómo lo hemos aprendido? </h4>
                                <p class="list-group-item-text">{{how}}</p>
                              </a>
                              <a href="#" class="list-group-item list-group-item-default">
                                <h4 class="list-group-item-heading">¿Qué he entendido bien? </h4>
                                <p class="list-group-item-text">{{understood}}</p>
                              </a>
                              <a href="#" class="list-group-item list-group-item-default">
                                <h4 class="list-group-item-heading">¿Qué cosas no acabo de entender?</h4>
                                <p class="list-group-item-text">{{notunderstood}}</p>
                              </a>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                  {{/each}}

              </div>
            </div>
          </div>
        </div>
        <div class="panel panel-info">
          <div class="panel-heading" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseGrades" aria-expanded="false" aria-controls="collapseGrades" id="headingGrades">
            <li class="panel-title list-group-item">
                Notas
            </li>
          </div>
          <div id="collapseGrades" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingGrades">
            <div class="panel-body">
              <table class="table table-bordered">
                {{#with student}}
                <tbody>
                  <tr>
                    <td>
                      XP
                    </td>
                    <td>
                      {{XP}}
                    </td>
                    <td>
                      {{notaXP XP}}
                    </td>
                  </tr>
                  <tr>
                    <td>
                      Badges
                    </td>
                    <td>
                      {{badges.length}}
                    </td>
                    <td>
                      {{notaBadges badges.length}}
                    </td>
                  </tr>
                  {{#each missions}}
                    <tr>
                      <td>
                        Misión: {{chalName}}
                      </td>
                      <td>
                        {{CP _id}}
                      </td>
                      <td class="nota_mision">
                        {{notaMision _id}}
                      </td>
                    </tr>
                  {{/each}}
                  <tr>
                    <td>
                      Misiones:
                    </td>
                    <td>
                      Media
                    </td>
                    <td>
                      {{notaMediaMisiones}}
                    </td>
                  </tr>
                  <tr>
                    <td>
                      Retos:
                    </td>
                    <td>
                      Media
                    </td>
                    <td>
                      {{notaRetos}}
                    </td>
                  </tr>
                  <tr>
                    <td>
                      Puntos HP
                    </td>
                    <td>
                      Puntos perdidos por HP
                    </td>
                    <td>
                      {{notaHP}}
                    </td>
                  </tr>
                  <tr>
                    <td>
                      Nota Final
                    </td>
                    <td>
                      Media ponderada XP, Misiones y Retos
                    </td>
                    <td>
                      {{notaFinal}}
                    </td>
                  </tr>
                </tbody>
                {{/with}}
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    {{#if myuser}}
      <div class="container-fluid">
        <form class="diario">
          <div class="form-group">
            <h2 class="text-center bg-info">Entrada diario</h2>
            <!-- <input type="text" class="form-control" id="sLevel" name="sLevel" value="{{level}}" {{inputDisabled}}>-->
            <label for="que" class="control-label">Misión actual</label>
            <select class="form-control" id="mission" name="mission">
              {{#each selectMissions}}
                <option value="{{_id}}" {{missionSelected _id}}>{{chalName}}</option>
              {{/each}}
            </select>
            <label for="que" class="control-label">¿Qué hemos aprendido hoy?</label>
            <input type="text" class="form-control" id="que" name="que" value="">
            <label for="como" class="control-label">¿Cómo lo hemos aprendido? </label>
            <input type="text" class="form-control" id="como" name="como" value="">
            <label for="entendido" class="control-label">¿Qué he entendido bien?</label>
            <input type="text" class="form-control" id="entendido" name="entendido"  value="">
            <label for="noentendido" class="control-label">¿Qué cosas no acabo de entender?</label>
            <input type="text" class="form-control" id="noentendido" name="noentendido"  value="">
          </div>
          <div class="form-group">
            <button type="button" class="btn btn-default">Volver a clase</button>
            <input type="submit" class="btn btn-primary" value="Guardar entrada diario">
          </div>
        </form>
      </div>
    {{/if}}
  </div>
</template>
