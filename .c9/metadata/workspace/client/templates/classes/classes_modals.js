{"filter":false,"title":"classes_modals.js","tooltip":"/client/templates/classes/classes_modals.js","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":35,"column":24},"end":{"row":35,"column":25},"action":"insert","lines":["p"],"id":147}],[{"start":{"row":35,"column":25},"end":{"row":35,"column":26},"action":"insert","lines":["r"],"id":148}],[{"start":{"row":35,"column":26},"end":{"row":35,"column":27},"action":"insert","lines":["o"],"id":149}],[{"start":{"row":35,"column":27},"end":{"row":35,"column":28},"action":"insert","lines":["f"],"id":150}],[{"start":{"row":35,"column":28},"end":{"row":35,"column":29},"action":"insert","lines":["i"],"id":151}],[{"start":{"row":35,"column":29},"end":{"row":35,"column":30},"action":"insert","lines":["l"],"id":152}],[{"start":{"row":35,"column":30},"end":{"row":35,"column":31},"action":"insert","lines":["e"],"id":153}],[{"start":{"row":35,"column":31},"end":{"row":35,"column":32},"action":"insert","lines":["."],"id":154}],[{"start":{"row":35,"column":32},"end":{"row":35,"column":44},"action":"insert","lines":["emailAddress"],"id":155}],[{"start":{"row":35,"column":45},"end":{"row":35,"column":46},"action":"insert","lines":[";"],"id":156}],[{"start":{"row":33,"column":43},"end":{"row":34,"column":0},"action":"insert","lines":["",""],"id":157},{"start":{"row":34,"column":0},"end":{"row":34,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":34,"column":6},"end":{"row":34,"column":7},"action":"insert","lines":["a"],"id":158}],[{"start":{"row":34,"column":7},"end":{"row":34,"column":8},"action":"insert","lines":["l"],"id":159}],[{"start":{"row":34,"column":8},"end":{"row":34,"column":9},"action":"insert","lines":["e"],"id":160}],[{"start":{"row":34,"column":9},"end":{"row":34,"column":10},"action":"insert","lines":["r"],"id":161}],[{"start":{"row":34,"column":10},"end":{"row":34,"column":11},"action":"insert","lines":["t"],"id":162}],[{"start":{"row":34,"column":11},"end":{"row":34,"column":13},"action":"insert","lines":["()"],"id":163}],[{"start":{"row":34,"column":12},"end":{"row":34,"column":14},"action":"insert","lines":["\"\""],"id":164}],[{"start":{"row":34,"column":13},"end":{"row":34,"column":14},"action":"insert","lines":["H"],"id":165}],[{"start":{"row":34,"column":16},"end":{"row":34,"column":17},"action":"insert","lines":[";"],"id":166}],[{"start":{"row":35,"column":14},"end":{"row":35,"column":15},"action":"remove","lines":["s"],"id":167}],[{"start":{"row":35,"column":14},"end":{"row":35,"column":15},"action":"insert","lines":["g"],"id":168}],[{"start":{"row":34,"column":0},"end":{"row":34,"column":17},"action":"remove","lines":["      alert(\"H\");"],"id":169}],[{"start":{"row":33,"column":43},"end":{"row":34,"column":0},"action":"remove","lines":["",""],"id":170}],[{"start":{"row":38,"column":23},"end":{"row":38,"column":41},"action":"insert","lines":["gcStudent.profile."],"id":171}],[{"start":{"row":38,"column":41},"end":{"row":38,"column":42},"action":"insert","lines":["n"],"id":172}],[{"start":{"row":38,"column":42},"end":{"row":38,"column":43},"action":"insert","lines":["a"],"id":173}],[{"start":{"row":38,"column":43},"end":{"row":38,"column":44},"action":"insert","lines":["m"],"id":174}],[{"start":{"row":38,"column":44},"end":{"row":38,"column":45},"action":"insert","lines":["e"],"id":175}],[{"start":{"row":38,"column":45},"end":{"row":38,"column":46},"action":"insert","lines":["."],"id":176}],[{"start":{"row":38,"column":46},"end":{"row":38,"column":54},"action":"insert","lines":["fullName"],"id":177}],[{"start":{"row":38,"column":54},"end":{"row":38,"column":55},"action":"remove","lines":["s"],"id":178}],[{"start":{"row":38,"column":54},"end":{"row":38,"column":55},"action":"remove","lines":["t"],"id":179}],[{"start":{"row":38,"column":54},"end":{"row":38,"column":55},"action":"remove","lines":["u"],"id":180}],[{"start":{"row":38,"column":54},"end":{"row":38,"column":55},"action":"remove","lines":["d"],"id":181}],[{"start":{"row":38,"column":54},"end":{"row":38,"column":55},"action":"remove","lines":["e"],"id":182}],[{"start":{"row":38,"column":54},"end":{"row":38,"column":55},"action":"remove","lines":["n"],"id":183}],[{"start":{"row":38,"column":54},"end":{"row":38,"column":55},"action":"remove","lines":["t"],"id":184}],[{"start":{"row":38,"column":54},"end":{"row":38,"column":55},"action":"remove","lines":["N"],"id":185}],[{"start":{"row":38,"column":54},"end":{"row":38,"column":55},"action":"remove","lines":["a"],"id":186}],[{"start":{"row":38,"column":54},"end":{"row":38,"column":55},"action":"remove","lines":["m"],"id":187}],[{"start":{"row":38,"column":54},"end":{"row":38,"column":55},"action":"remove","lines":["e"],"id":188}],[{"start":{"row":39,"column":17},"end":{"row":39,"column":28},"action":"remove","lines":["studentName"],"id":189},{"start":{"row":39,"column":17},"end":{"row":39,"column":48},"action":"insert","lines":["gcStudent.profile.name.fullName"]}],[{"start":{"row":39,"column":40},"end":{"row":39,"column":48},"action":"remove","lines":["fullName"],"id":190},{"start":{"row":39,"column":40},"end":{"row":39,"column":49},"action":"insert","lines":["givenName"]}],[{"start":{"row":39,"column":50},"end":{"row":40,"column":0},"action":"insert","lines":["",""],"id":191},{"start":{"row":40,"column":0},"end":{"row":40,"column":10},"action":"insert","lines":["          "]}],[{"start":{"row":40,"column":10},"end":{"row":40,"column":16},"action":"insert","lines":["email:"],"id":192}],[{"start":{"row":40,"column":16},"end":{"row":40,"column":34},"action":"insert","lines":["gcStudent.profile."],"id":193}],[{"start":{"row":40,"column":34},"end":{"row":40,"column":46},"action":"insert","lines":["emailAddress"],"id":194}],[{"start":{"row":40,"column":46},"end":{"row":40,"column":47},"action":"insert","lines":[","],"id":195}],[{"start":{"row":40,"column":47},"end":{"row":41,"column":0},"action":"insert","lines":["",""],"id":196},{"start":{"row":41,"column":0},"end":{"row":41,"column":10},"action":"insert","lines":["          "]}],[{"start":{"row":41,"column":10},"end":{"row":41,"column":11},"action":"insert","lines":["g"],"id":197}],[{"start":{"row":41,"column":11},"end":{"row":41,"column":12},"action":"insert","lines":["c"],"id":198}],[{"start":{"row":41,"column":12},"end":{"row":41,"column":13},"action":"insert","lines":["I"],"id":199}],[{"start":{"row":41,"column":13},"end":{"row":41,"column":14},"action":"insert","lines":["d"],"id":200}],[{"start":{"row":41,"column":14},"end":{"row":41,"column":15},"action":"insert","lines":[":"],"id":201}],[{"start":{"row":41,"column":12},"end":{"row":41,"column":13},"action":"insert","lines":["s"],"id":202}],[{"start":{"row":41,"column":16},"end":{"row":41,"column":26},"action":"insert","lines":["gcStudent."],"id":203}],[{"start":{"row":41,"column":26},"end":{"row":41,"column":32},"action":"insert","lines":["userId"],"id":204}],[{"start":{"row":41,"column":32},"end":{"row":41,"column":33},"action":"insert","lines":[","],"id":205}],[{"start":{"row":62,"column":9},"end":{"row":62,"column":10},"action":"remove","lines":["/"],"id":206}],[{"start":{"row":62,"column":8},"end":{"row":62,"column":9},"action":"remove","lines":["/"],"id":207}],[{"start":{"row":33,"column":7},"end":{"row":33,"column":8},"action":"remove","lines":["/"],"id":208}],[{"start":{"row":33,"column":6},"end":{"row":33,"column":7},"action":"remove","lines":["/"],"id":209}],[{"start":{"row":35,"column":0},"end":{"row":35,"column":46},"action":"remove","lines":["        alert(gcStudent.profile.emailAddress);"],"id":210}],[{"start":{"row":34,"column":74},"end":{"row":35,"column":0},"action":"remove","lines":["",""],"id":211}],[{"start":{"row":61,"column":8},"end":{"row":61,"column":9},"action":"insert","lines":["/"],"id":212}],[{"start":{"row":61,"column":9},"end":{"row":61,"column":10},"action":"insert","lines":["/"],"id":213}],[{"start":{"row":33,"column":41},"end":{"row":34,"column":0},"action":"insert","lines":["",""],"id":214},{"start":{"row":34,"column":0},"end":{"row":34,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":34,"column":6},"end":{"row":34,"column":36},"action":"insert","lines":["if (Session.get(\"gcId\")==\"\") {"],"id":215}],[{"start":{"row":34,"column":29},"end":{"row":34,"column":30},"action":"insert","lines":["!"],"id":216}],[{"start":{"row":34,"column":30},"end":{"row":34,"column":31},"action":"remove","lines":["="],"id":217}],[{"start":{"row":35,"column":6},"end":{"row":35,"column":8},"action":"insert","lines":["  "],"id":218}],[{"start":{"row":63,"column":9},"end":{"row":63,"column":10},"action":"insert","lines":[" "],"id":219}],[{"start":{"row":63,"column":10},"end":{"row":63,"column":12},"action":"insert","lines":["  "],"id":220}],[{"start":{"row":63,"column":12},"end":{"row":63,"column":14},"action":"insert","lines":["  "],"id":221}],[{"start":{"row":63,"column":14},"end":{"row":63,"column":16},"action":"insert","lines":["  "],"id":222}],[{"start":{"row":63,"column":16},"end":{"row":63,"column":18},"action":"insert","lines":["  "],"id":223}],[{"start":{"row":35,"column":0},"end":{"row":35,"column":2},"action":"insert","lines":["  "],"id":224},{"start":{"row":36,"column":0},"end":{"row":36,"column":2},"action":"insert","lines":["  "]},{"start":{"row":37,"column":0},"end":{"row":37,"column":2},"action":"insert","lines":["  "]},{"start":{"row":38,"column":0},"end":{"row":38,"column":2},"action":"insert","lines":["  "]},{"start":{"row":39,"column":0},"end":{"row":39,"column":2},"action":"insert","lines":["  "]},{"start":{"row":40,"column":0},"end":{"row":40,"column":2},"action":"insert","lines":["  "]},{"start":{"row":41,"column":0},"end":{"row":41,"column":2},"action":"insert","lines":["  "]},{"start":{"row":42,"column":0},"end":{"row":42,"column":2},"action":"insert","lines":["  "]},{"start":{"row":43,"column":0},"end":{"row":43,"column":2},"action":"insert","lines":["  "]},{"start":{"row":44,"column":0},"end":{"row":44,"column":2},"action":"insert","lines":["  "]},{"start":{"row":45,"column":0},"end":{"row":45,"column":2},"action":"insert","lines":["  "]},{"start":{"row":46,"column":0},"end":{"row":46,"column":2},"action":"insert","lines":["  "]},{"start":{"row":47,"column":0},"end":{"row":47,"column":2},"action":"insert","lines":["  "]},{"start":{"row":48,"column":0},"end":{"row":48,"column":2},"action":"insert","lines":["  "]},{"start":{"row":49,"column":0},"end":{"row":49,"column":2},"action":"insert","lines":["  "]},{"start":{"row":50,"column":0},"end":{"row":50,"column":2},"action":"insert","lines":["  "]},{"start":{"row":51,"column":0},"end":{"row":51,"column":2},"action":"insert","lines":["  "]},{"start":{"row":52,"column":0},"end":{"row":52,"column":2},"action":"insert","lines":["  "]},{"start":{"row":53,"column":0},"end":{"row":53,"column":2},"action":"insert","lines":["  "]},{"start":{"row":54,"column":0},"end":{"row":54,"column":2},"action":"insert","lines":["  "]},{"start":{"row":55,"column":0},"end":{"row":55,"column":2},"action":"insert","lines":["  "]},{"start":{"row":56,"column":0},"end":{"row":56,"column":2},"action":"insert","lines":["  "]},{"start":{"row":57,"column":0},"end":{"row":57,"column":2},"action":"insert","lines":["  "]},{"start":{"row":58,"column":0},"end":{"row":58,"column":2},"action":"insert","lines":["  "]},{"start":{"row":59,"column":0},"end":{"row":59,"column":2},"action":"insert","lines":["  "]},{"start":{"row":60,"column":0},"end":{"row":60,"column":2},"action":"insert","lines":["  "]},{"start":{"row":61,"column":0},"end":{"row":61,"column":2},"action":"insert","lines":["  "]},{"start":{"row":62,"column":0},"end":{"row":62,"column":2},"action":"insert","lines":["  "]},{"start":{"row":63,"column":0},"end":{"row":63,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":63,"column":13},"end":{"row":63,"column":20},"action":"remove","lines":["       "],"id":225},{"start":{"row":63,"column":13},"end":{"row":64,"column":0},"action":"insert","lines":["",""]},{"start":{"row":64,"column":0},"end":{"row":64,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":64,"column":6},"end":{"row":64,"column":8},"action":"remove","lines":["  "],"id":226}],[{"start":{"row":64,"column":6},"end":{"row":64,"column":7},"action":"insert","lines":["}"],"id":227}],[{"start":{"row":33,"column":6},"end":{"row":33,"column":7},"action":"insert","lines":["n"],"id":228}],[{"start":{"row":33,"column":7},"end":{"row":33,"column":8},"action":"insert","lines":["="],"id":229}],[{"start":{"row":33,"column":43},"end":{"row":34,"column":0},"action":"insert","lines":["",""],"id":230},{"start":{"row":34,"column":0},"end":{"row":34,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":34,"column":6},"end":{"row":34,"column":7},"action":"insert","lines":["a"],"id":231}],[{"start":{"row":34,"column":7},"end":{"row":34,"column":8},"action":"insert","lines":["l"],"id":232}],[{"start":{"row":34,"column":8},"end":{"row":34,"column":9},"action":"insert","lines":["e"],"id":233}],[{"start":{"row":34,"column":9},"end":{"row":34,"column":10},"action":"insert","lines":["r"],"id":234}],[{"start":{"row":34,"column":10},"end":{"row":34,"column":11},"action":"insert","lines":["t"],"id":235}],[{"start":{"row":34,"column":11},"end":{"row":34,"column":13},"action":"insert","lines":["()"],"id":236}],[{"start":{"row":34,"column":12},"end":{"row":34,"column":13},"action":"insert","lines":["n"],"id":237}],[{"start":{"row":34,"column":14},"end":{"row":34,"column":15},"action":"insert","lines":[";"],"id":238}],[{"start":{"row":33,"column":7},"end":{"row":33,"column":8},"action":"remove","lines":["="],"id":239}],[{"start":{"row":33,"column":6},"end":{"row":33,"column":7},"action":"remove","lines":["n"],"id":240}],[{"start":{"row":34,"column":12},"end":{"row":34,"column":13},"action":"remove","lines":["n"],"id":241}],[{"start":{"row":34,"column":12},"end":{"row":34,"column":34},"action":"insert","lines":["Session.get('classId')"],"id":242}],[{"start":{"row":34,"column":0},"end":{"row":34,"column":36},"action":"remove","lines":["      alert(Session.get('classId'));"],"id":243}],[{"start":{"row":33,"column":41},"end":{"row":34,"column":0},"action":"remove","lines":["",""],"id":244}],[{"start":{"row":62,"column":11},"end":{"row":62,"column":12},"action":"remove","lines":["/"],"id":245}],[{"start":{"row":62,"column":10},"end":{"row":62,"column":11},"action":"remove","lines":["/"],"id":246}],[{"start":{"row":0,"column":0},"end":{"row":108,"column":0},"action":"remove","lines":["Template.classesModals.helpers({","  mensaje: function(){","    var userType=Session.get('userType');","    if ( userType == \"teacher\") {","      return \"Nueva clase o proyecto\";","    } else {","      return \"Código de la clase\"","    }","  }","});","","Template.classesModals.events({","  'submit form': function(event) {","    var userType=Session.get('userType');","    if ( userType == \"teacher\") {","      event.preventDefault();","      if (Session.get(\"gcId\")==\"\") {","        cn=$(event.target).find('[name=class-name]').val();","      } else {","        cn=$.grep(Session.get('lc'), function(e){ return e.id == Session.get(\"gcId\"); })[0].name;","      }","      var user = Meteor.user();","      var classe = {","        teacherId: user._id,","        className: cn,","        gcId: Session.get(\"gcId\"),","        iniHP: 10,","        stored: false,","        groupImg: \"https://res.cloudinary.com/myclassgame/image/upload/v1543412151/proves/grupo.png\",","        evaluation: 1,","        CoinXP: true,","        createdOn: new Date()","      };","      Meteor.call('classInsert', classe);","      if (Session.get(\"gcId\")!=\"\") {","          Session.get('sc'+Session.get(\"gcId\")).forEach(function (gcStudent) {","          var student = {","            classId: Session.get('classId'),","            studentName: gcStudent.profile.name.fullName,","            alias: gcStudent.profile.name.givenName,","            email:gcStudent.profile.emailAddress,","            gcsId:gcStudent.userId,","            groupId: 0,","            XP: 0,","            HP: 10,","            level: 0,","            coins: 0,","            rs: 0,","            os: 0,","            ys: 0,","            ws: 0,","            bs: 0,","            gs: 0,","            badges: [],","            items: [],","            cards: [],","            powers: [],","            collection: [],","            selected: 0,","            conected: 0,","            createdOn: new Date()","          };","          Meteor.call('studentInsert', student);","        });  ","      }","      $('#add_class_modal').modal('hide');","      return false;","    } else {","      event.preventDefault();","      var classId= $(event.target).find('[name=class-name]').val();","      Meteor.call('studentClassInsert', classId);","      $('#add_class_modal').modal('hide');","      return false;","    }","  }","});","","Template.deleteClass.events({","  'submit form': function(event) {","    Meteor.call('classDelete', Session.get('classId'));","    Modal.hide('deleteClass');","    Session.set('classId', \"\");","    Session.set('className', '');","    Router.go(\"classesPage\");","  }","});","","Template.adminClass.events({","  'submit form': function(event) {","    //alert($(event.target).find('[name=class-name]').val());","    event.preventDefault();","    regla=\"^\" + $(event.target).find('[name=class-name]').val();","    n=classes.find({\"_id\" : {'$regex' : regla }}).count();","    if (n==1){","      cId=classes.findOne({\"_id\" : {'$regex' : regla }})._id;","      cName=classes.findOne({\"_id\" : {'$regex' : regla }}).className;","      Session.set('classId', cId);","      Session.set('className', cName);","      Session.setPersistent('navItem', \"Students\");","      Session.setPersistent('sogBtn',\"students\");","      Session.setPersistent('golBtn',\"grid\");","      Session.set('studentSelected', false);","      Session.setPersistent('evaluation',classes.findOne({_id:Session.get('classId')}).evaluation);","    }","    Router.go(\"myNav\",{_id:Session.get('classId')});","    Modal.hide('adminClass');","  }","});",""],"id":247},{"start":{"row":0,"column":0},"end":{"row":138,"column":0},"action":"insert","lines":["Template.classesModals.helpers({","  mensaje: function(){","    var userType=Session.get('userType');","    if ( userType == \"teacher\") {","      return \"Nueva clase o proyecto\";","    } else {","      return \"Código de la clase\"","    }","  },","  types: function() {","    var teacherId = Meteor.user();","    var userType=Session.get('userType');","    var tipos=mcgParameters.findOne().typeClasses;","    return classes.find({'_id': { \"$in\": tipos } });","  },","  classImage: function() {","    avatar=this.groupImg;","    if (avatar) {","      if (avatar.substring(0, 4)==\"http\") {","        return avatar;","      } else {","        return images.findOne({_id: avatar}).image_url;","      }","    } else {","      return \"https://res.cloudinary.com/myclassgame/image/upload/v1543412151/proves/grupo.png\";","    }","  }","});","","Template.classesModals.events({","  'submit form': function(event) {","    userType=$(\".active\").get(1).id;","    Session.set('userType',userType);","    if ( userType == \"teacher\") {","      event.preventDefault();","      if (Session.get(\"gcId\")==\"\") {","        cn=$(event.target).find('[name=class-name-teacher]').val();","      } else {","        cn=$.grep(Session.get('lc'), function(e){ return e.id == Session.get(\"gcId\"); })[0].name;","      }","      if (cn!=\"\"){","        var user = Meteor.user();","        var classe = {","          teacherId: user._id,","          className: cn,","          gcId: Session.get(\"gcId\"),","          iniHP: 10,","          stored: false,","          groupImg: \"https://res.cloudinary.com/myclassgame/image/upload/v1543412151/proves/grupo.png\",","          evaluation: 1,","          CoinXP: true,","          createdOn: new Date()","        };","        cId=Meteor.call('classInsert', classe);","        Meteor.call('teacherInClass',Session.get(\"classId\"));","      }","      var otherClassId= $(\"#class-name-other-teacher\").val();","      if (otherClassId !=\"\"){","        Meteor.call('otherTeacherInsert', otherClassId);","      }","      if (Session.get(\"gcId\")!=\"\") {","          Session.get('sc'+Session.get(\"gcId\")).forEach(function (gcStudent) {","          var student = {","            classId: Session.get('classId'),","            studentName: gcStudent.profile.name.fullName,","            alias: gcStudent.profile.name.givenName,","            email:gcStudent.profile.emailAddress,","            gcsId:gcStudent.userId,","            groupId: 0,","            XP: 0,","            HP: 10,","            level: 0,","            coins: 0,","            rs: 0,","            os: 0,","            ys: 0,","            ws: 0,","            bs: 0,","            gs: 0,","            badges: [],","            items: [],","            cards: [],","            powers: [],","            collection: [],","            selected: 0,","            conected: 0,","            createdOn: new Date()","          };","          Meteor.call('studentInsert', student);","        });  ","      }","    } else {","      event.preventDefault();","      if ( userType == \"student\") {","        var classId= $(\"#class-name-student\").val();","        Meteor.call('studentClassInsert', classId);","      } else {","        var classId= $(event.target).find('[name=class-name-parent]').val();","        Meteor.call('parentClassInsert', classId);","      }","    }","    Meteor.subscribe(\"classes\");","    $('#add_class_modal').modal('hide');","    return false;","  }","});","","Template.deleteClass.events({","  'submit form': function(event) {","    Meteor.call('classDelete', Session.get('classId'));","    Modal.hide('deleteClass');","    Session.set('classId', \"\");","    Session.set('className', '');","    Router.go(\"classesPage\");","  }","});","","Template.adminClass.events({","  'submit form': function(event) {","    //alert($(event.target).find('[name=class-name]').val());","    event.preventDefault();","    regla=\"^\" + $(event.target).find('[name=class-name]').val();","    n=classes.find({\"_id\" : {'$regex' : regla }}).count();","    if (n==1){","      cId=classes.findOne({\"_id\" : {'$regex' : regla }})._id;","      cName=classes.findOne({\"_id\" : {'$regex' : regla }}).className;","      Session.set('classId', cId);","      Session.set('className', cName);","      Session.setPersistent('navItem', \"Students\");","      Session.setPersistent('sogBtn',\"students\");","      Session.setPersistent('golBtn',\"grid\");","      Session.set('studentSelected', false);","      Session.setPersistent('evaluation',classes.findOne({_id:Session.get('classId')}).evaluation);","    }","    Router.go(\"myNav\",{_id:Session.get('classId')});","    Modal.hide('adminClass');","  }","});",""]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":138,"column":0},"end":{"row":138,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1559684461614,"hash":"29467d44a4e631bf8b60b8b3194c0d7757fe9d6e"}